(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{7362:function(e,t,a){Promise.resolve().then(a.bind(a,2642))},2642:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return b}});var r=a(7437),n=a(2265),l=a(7211);function s(e){let{task:t}=e;return(0,r.jsx)("div",{className:"rounded-2xl overflow-hidden group border border-black/10 dark:border-transparent",children:(0,r.jsxs)(l.fC,{className:"lg:max-w-2xl w-full h-[600px] overflow-y-auto overflow-x-hidden flex justify-end items-start rounded-2xl bg-black/5 dark:bg-white/25",children:[(0,r.jsx)(l.l_,{className:"w-full h-full rounded-2xl",children:(0,r.jsxs)("div",{className:"w-full h-full p-4 md:p-8 flex flex-col justify-start items-center",children:[t.image&&(0,r.jsx)("img",{src:t.image,alt:"image associated with the task",className:"rounded-lg w-full md:w-auto max-w-72 mb-4 mx-auto"}),(0,r.jsx)("p",{className:"md:text-[17px] text-[15px] tracking-wide !leading-6 font-normal w-full h-fit",children:t.value})]})}),(0,r.jsx)(l.LW,{className:"flex select-none touch-none p-0.5 bg-transparent transition-colors duration-[160ms] ease-out group-hover:bg-transparent data-[orientation=vertical]:w-2.5 data-[orientation=horizontal]:flex-col data-[orientation=horizontal]:h-2.5",orientation:"vertical",children:(0,r.jsx)(l.bU,{className:"flex-1 relative before:content-[''] before:absolute before:top-1/2 before:left-1/2 before:-translate-x-1/2 before:-translate-y-1/2 before:w-full before:h-full before:min-w-[44px] before:min-h-[44px] rounded-full dark:bg-transparent dark:group-hover:bg-white/50 dark:hover:bg-white/50 transition-all !duration-0 bg-transparent group-hover:bg-neutral-800 hover:bg-neutral-800;"})}),(0,r.jsx)(l.Ns,{className:"bg-red-600"})]})})}var i=a(7593);function o(e){let{label:t,...a}=e;return(0,r.jsxs)("label",{htmlFor:a.id||t,className:"flex justify-start items-center gap-x-4 rounded-xl p-4 dark:bg-neutral-950 border dark:border-neutral-900 hover:border-charcoal dark:hover:border-pink transition-all duration-200 ease-in-out",children:[(0,r.jsx)("input",{id:a.id||t,type:"radio",className:"appearance-none md:w-[18px] md:h-[18px] w-4 h-4 shrink-0 ring-2 ring-neutral-900 border-4 border-transparent rounded-full checked:ring-charcoal checked:bg-charcoal checked:border-neutral-50 dark:ring-white dark:border-transparent dark:checked:bg-neutral-pink dark:checked:border-neutral-950 dark:checked:bg-pink dark:checked:ring-pink transition-all duration-200 ease-in-out",...a}),(0,r.jsx)("label",{htmlFor:a.id||t,className:"md:text-base text-sm font-light",children:t})]})}var d=a(6288),c=a(6487);function u(e){var t;let{task:a,onSubmit:l,submitting:u,onTimeout:x}=e,[f,m]=(0,n.useState)(""),[h,b]=(0,n.useState)(null),[g,k]=(0,n.useState)(),[w,v]=(0,n.useState)(Math.floor(a.expiry-Date.now()/1e3)),[y]=(0,n.useState)(new Audio("/sounds/time-ending.mp3")),[j]=(0,n.useState)(new Audio("/sounds/new-task.mp3")),{audioEnabled:N}=(0,c.Z)();return(0,n.useEffect)(()=>{N?(y.volume=1,j.volume=1):(y.volume=0,j.volume=0)},[N,y,j]),(0,n.useEffect)(()=>{w<10&&w>1&&y.paused&&(y.currentTime=0,y.play().catch(console.error)),w<=0&&(y.paused||(y.pause(),y.currentTime=0),x(),b(null),m(""))},[w,x,y]),(0,n.useEffect)(()=>{console.log("Expiry: ",a.expiry-Date.now()/1e3);let e=setInterval(()=>{v(Math.floor(a.expiry-Date.now()/1e3))},1e3);return()=>clearInterval(e)},[a.expiry]),(0,n.useEffect)(()=>{a.id!==g&&(k(a.id),b(a.options?a.options[0]:null),m(""),j.paused&&w>10&&(j.currentTime=0,j.play().catch(console.error)))},[g,a.id,a.options]),(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(s,{task:a}),(0,r.jsx)("div",{className:"w-full lg:max-w-md border border-black/10 backdrop-blur-3xl dark:border-white/10 lg:min-h-[600px] rounded-2xl bg-neutral-50 dark:bg-black/80 flex justify-center items-center",children:(0,r.jsxs)("div",{className:"flex flex-col justify-center items-center gap-y-6 p-6 md:p-8 lg:px-8 lg:py-10 w-full",children:[(0,r.jsxs)("div",{className:"w-full",children:["Time Left: ",w]}),(0,r.jsxs)("form",{onSubmit:e=>{if(e.preventDefault(),"select"===a.type&&null!==h){if(a.expiry-Date.now()/1e3<=0){x();return}if(!h||a.options&&!a.options.includes(h)){d.A.error("Please select an option first");return}l(h,a.id)}else"text"===a.type&&""!==f&&""!==f.trim()&&l(f,a.id);b(null),m("")},className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-1 gap-4 w-full text-left",children:[(0,r.jsx)("h3",{className:"md:text-lg text-base font-medium col-span-full",children:a.label}),"select"===a.type?null===(t=a.options)||void 0===t?void 0:t.map((e,t)=>(0,r.jsx)(o,{id:e,name:"option",label:e,value:e,checked:e===h,onChange:e=>{let{currentTarget:t}=e;b(t.value)}},t)):(0,r.jsx)("input",{type:"text",value:f,placeholder:"Enter your answer",onChange:e=>{let{currentTarget:t}=e;return m(t.value)},className:"border-2 border-charcoal/30  focus:border-charcoal bg-transparent dark:bg-neutral-900 dark:border-neutral-900  dark:focus:border-pink h-14 rounded-xl px-4 transition-all duration-300 ease-in-out outline-none ring-0 text-charcoal dark:text-white text-base font-normal !leading-5",autoComplete:"off"}),(0,r.jsx)("br",{}),(0,r.jsxs)("button",{type:"submit",disabled:u||"select"===a.type&&null===h||"text"===a.type&&""===f,className:"bg-gradient-to-br relative group/btn bg-neutral-900 w-full text-white rounded-xl h-14 font-medium shadow-[0px_1px_0px_0px_#ffffff40_inset,0px_-1px_0px_0px_#ffffff40_inset] dark:shadow-[0px_1px_0px_0px_var(--zinc-800)_inset,0px_-1px_0px_0px_var(--zinc-800)_inset] mt-4 col-span-full flex justify-center items-center disabled:text-opacity-40 disabled:bg-opacity-50",children:[(0,r.jsx)("span",{className:"".concat(u?"opacity-0":"opacity-100"),children:"Submit"}),u&&(0,r.jsx)("span",{className:"animate-spin absolute w-fit h-fit shrink-0",children:(0,r.jsx)(i.Z,{className:"h-auto w-5 shrink-0"})}),(0,r.jsx)(p,{})]})]})]})})]})}let p=()=>(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("span",{className:"group-hover/btn:opacity-100 block transition duration-500 opacity-0 absolute h-px w-full -bottom-px inset-x-0 bg-gradient-to-r from-transparent via-aqua dark:via-pink to-transparent"}),(0,r.jsx)("span",{className:"group-hover/btn:opacity-100 blur-sm block transition duration-500 opacity-0 absolute h-px w-1/2 mx-auto -bottom-px inset-x-10 bg-gradient-to-r from-transparent via-aqua dark:via-pink to-transparent"})]});var x=a(5975),f=a(2020),m=a(9079);let h=(0,f.Ue)()((e,t)=>({tasks:[],isLoading:!1,currentTask:null,fetchTasks:async()=>{if(t().isLoading)return;let a=m.env.URL?m.env.URL:"";e({isLoading:!0});try{let t=await fetch("".concat(a,"/api/tasks"),{method:"GET",headers:{"Content-Type":"application/json"}}),r=await t.json();r=r.filter(e=>e.expiry>Date.now()/1e3),e({tasks:r,isLoading:!1,currentTask:r[0]})}catch(t){console.error("Error fetching tasks:",t),e({isLoading:!1})}},submitAnswer:async t=>{try{await fetch("/api/answer",{method:"POST",body:JSON.stringify(t),headers:{"Content-Type":"application/json"}}),e(e=>({tasks:e.tasks.filter(e=>e.id!==t.id),currentTask:e.tasks.length>0&&e.tasks.find(e=>!e.answer&&e.expiry>Date.now()/1e3)||null})),h.getState().fetchTasks()}catch(e){console.error("Error submitting answer:",e)}},taskTimeout:()=>{e(e=>({tasks:e.tasks.filter(t=>{var a;return t.id!==(null===(a=e.currentTask)||void 0===a?void 0:a.id)}),currentTask:e.tasks.length>0&&e.tasks.find(e=>!e.answer&&e.expiry>Date.now()/1e3)||null}))}}));function b(){let{isLoading:e,currentTask:t,submitAnswer:a,taskTimeout:l}=h(),[s,i]=(0,n.useState)(!1),o=async(e,t)=>{if(!s){i(!0);try{await a({answer:e,id:t})}catch(e){console.error("Error submitting answer:",e)}finally{i(!1)}}};return(0,r.jsx)(r.Fragment,{children:t?(0,r.jsx)("div",{className:"w-full py-[72px] h-full flex flex-col items-center px-[5%]",children:(0,r.jsx)("div",{className:"flex flex-col lg:flex-row justify-center items-center gap-8 w-full max-w-screen-2xl",children:(0,r.jsx)(u,{task:t,onSubmit:o,onTimeout:()=>{console.log("Task timed out"),l()},submitting:s})})}):(0,r.jsx)("div",{className:"flex h-[calc(100vh-78px)] md:h-[calc(100vh-90px)] w-full align-middle justify-center items-center",children:e?(0,r.jsx)(x.Z,{className:"h-auto w-6 md:w-10 shrink-0 animate-spin -mt-[78px] md:-mt-[90px]"}):(0,r.jsxs)("p",{className:"md:text-4xl text-2xl font-normal text-center",children:["No tasks available at the moment."," ",(0,r.jsx)("br",{className:"md:flex hidden"})," Please wait."]})})})}h.getState().fetchTasks(),console.log("Starting polling"),setInterval(()=>{let{tasks:e,isLoading:t,fetchTasks:a,currentTask:r}=h.getState();(!t&&0===e.length||!r||r.expiry<Date.now()/1e3)&&a()},5e3)},6487:function(e,t,a){"use strict";let r=(0,a(2020).Ue)()((e,t)=>({audioEnabled:!1,toggleAudio:()=>e(e=>({audioEnabled:!e.audioEnabled}))}));t.Z=r}},function(e){e.O(0,[534,835,971,69,744],function(){return e(e.s=7362)}),_N_E=e.O()}]);